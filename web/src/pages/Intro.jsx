import { useEffect, useMemo, useState } from "react";import { useNavigate } from "react-router-dom";function fmtInt(x) {  if (x === null || x === undefined) return "—";  return new Intl.NumberFormat().format(x);}const PROFILES = [  { id: "news", title: "News & Politics", blurb: "You react to current events and public debates." },  { id: "gaming", title: "Gaming", blurb: "Let’s plays, esports, game reviews, patches, drama." },  { id: "music", title: "Music", blurb: "Clips, artists, live sessions, fan discussions." },  { id: "fitness", title: "Fitness", blurb: "Training, nutrition, transformation journeys." },  { id: "science", title: "Science & Education", blurb: "Explainers, curiosity, learning communities." },  { id: "tech", title: "Tech", blurb: "Devices, reviews, programming, gadget culture." },  { id: "comedy", title: "Comedy", blurb: "Sketches, memes, commentary, creators’ jokes." },  { id: "sports", title: "Sports", blurb: "Highlights, analysis, teams, fan arguments." },  { id: "movies", title: "Movies & TV", blurb: "Trailers, reactions, lore, critics and fans." },  { id: "mixed", title: "Mixed Explorer", blurb: "You comment across many topics and channels." }];export default function Intro() {  const nav = useNavigate();  const [stats, setStats] = useState(null);  const [author, setAuthor] = useState("");  const [profile, setProfile] = useState(PROFILES[0].id);  const [typedDone, setTypedDone] = useState(false);  useEffect(() => {    fetch(import.meta.env.BASE_URL + "data/site_stats.json")      .then((r) => r.json())      .then(setStats)      .catch(() => setStats(null));  }, []);  const years = stats?.years ?? "2014–2019";  const introText = useMemo(() => {    return (      `It has been 4 years since you started watching YouTube videos in the period ` +      `covered by the Youniverse dataset (${years}). ` +      `During these years, you left comments, reacted to creators, and—without realizing it—` +      `drifted toward people who comment in a similar way.\n\n` +      `In this data story, we use Youniverse to explore commenting communities and help you ` +      `find the profile that best matches your habits.`    );  }, [years]);  const chosen = useMemo(    () => PROFILES.find((p) => p.id === profile),    [profile]  );  function start() {    sessionStorage.setItem("chosen_profile", profile);    sessionStorage.setItem("author_input", author.trim());    nav("/User_community");  }  return (    <div style={{ padding: 32, maxWidth: 980, margin: "0 auto", fontFamily: "system-ui" }}>      <h1 style={{ marginBottom: 10 }}>Where do you belong in YouTube’s comment universe?</h1>      <Typewriter        text={introText}        speedMs={5}          // typing speed        startDelayMs={250}    // small pause before typing starts        onDone={() => setTypedDone(true)}      />      {/* Reveal everything else after typing */}      <div        style={{          marginTop: 18,          opacity: typedDone ? 1 : 0,          transform: typedDone ? "translateY(0px)" : "translateY(8px)",          transition: "opacity 600ms ease, transform 600ms ease",          pointerEvents: typedDone ? "auto" : "none",        }}      >          <div              style={{                  display: "grid", gridTemplateColumns: "repeat(3, minmax(0, 1fr))", gap: 12, marginTop: 14,              }}          >              <Stagger show={typedDone} delayMs={0}>                  <StatCard label="Comments (approx.)" value={fmtInt(stats?.num_comments)}/>              </Stagger>              <Stagger show={typedDone} delayMs={350}>                  <StatCard label="Authors" value={fmtInt(stats?.num_authors)}/>              </Stagger>              <Stagger show={typedDone} delayMs={700}>                  <StatCard label="Channels" value={fmtInt(stats?.num_channels)}/>              </Stagger>          </div>        <div style={{ marginTop: 22, padding: 18, border: "1px solid #e5e7eb", borderRadius: 16 }}>          <h2 style={{ marginTop: 0 }}>Start by choosing your “commenter profile”</h2>          <div style={{ display: "grid", gridTemplateColumns: "1.1fr 1fr", gap: 14 }}>            <div>              <label style={{ display: "block", fontWeight: 600, marginBottom: 6 }}>                Who are you? (optional)              </label>              <input                value={author}                onChange={(e) => setAuthor(e.target.value)}                placeholder="Type an author id / username (or leave empty)"                style={{                  width: "100%",                  padding: "10px 12px",                  borderRadius: 12,                  border: "1px solid #d1d5db",                }}              />              <p style={{ margin: "10px 0 0", color: "#6b7280" }}>                If we can’t match your exact author, you can still explore by profile.              </p>            </div>            <div>              <label style={{ display: "block", fontWeight: 600, marginBottom: 6 }}>                Pick a profile to begin              </label>              <select                value={profile}                onChange={(e) => setProfile(e.target.value)}                style={{                  width: "100%",                  padding: "10px 12px",                  borderRadius: 12,                  border: "1px solid #d1d5db",                }}              >                {PROFILES.map((p) => (                  <option key={p.id} value={p.id}>                    {p.title}                  </option>                ))}              </select>              <div style={{ marginTop: 10, padding: 12, borderRadius: 12, background: "#f9fafb" }}>                <div style={{ fontWeight: 800 }}>{chosen?.title}</div>                <div style={{ color: "#374151", marginTop: 4 }}>{chosen?.blurb}</div>              </div>            </div>          </div>          <div style={{ marginTop: 16, display: "flex", justifyContent: "flex-end", gap: 10 }}>            <button              onClick={start}              style={{                padding: "10px 14px",                borderRadius: 12,                border: "1px solid #111827",                background: "#111827",                color: "white",                cursor: "pointer",                fontWeight: 800,              }}            >              Start the journey →            </button>          </div>        </div>      </div>    </div>  );}/** Types text like a person writing; supports \n newlines. */function Typewriter({ text, speedMs = 20, startDelayMs = 0, onDone }) {  const [i, setI] = useState(0);  const [started, setStarted] = useState(false);  useEffect(() => {    const t = setTimeout(() => setStarted(true), startDelayMs);    return () => clearTimeout(t);  }, [startDelayMs]);  useEffect(() => {    if (!started) return;    if (i >= text.length) {      onDone?.();      return;    }    const t = setTimeout(() => setI((x) => x + 1), speedMs);    return () => clearTimeout(t);  }, [i, text.length, speedMs, started, onDone]);  const visible = text.slice(0, i);  return (    <div      style={{        whiteSpace: "pre-wrap",        fontSize: 16,        lineHeight: 1.6,        color: "#111827",        borderLeft: "3px solid #111827",        paddingLeft: 14,        marginTop: 6,      }}    >      {visible}      <Cursor show={started && i < text.length} />    </div>  );}/** Blinking cursor */function Cursor({ show }) {  return (    <span      aria-hidden="true"      style={{        display: show ? "inline-block" : "none",        width: 10,        marginLeft: 2,        borderBottom: "2px solid #111827",        transform: "translateY(-2px)",        animation: "blink 1s step-end infinite",      }}    >      {/* inline keyframes (no CSS file needed) */}      <style>{`        @keyframes blink { 50% { opacity: 0; } }      `}</style>    </span>  );}function Stagger({ show, delayMs = 0, children }) {  return (    <div      style={{        opacity: show ? 1 : 0,        transform: show ? "translateY(0px)" : "translateY(10px)",        transition: `opacity 600ms ease ${delayMs}ms, transform 600ms ease ${delayMs}ms`,        pointerEvents: show ? "auto" : "none",      }}    >      {children}    </div>  );}function StatCard({ label, value }) {  return (    <div style={{ padding: 16, border: "1px solid #e5e7eb", borderRadius: 16, background: "white" }}>      <div style={{ color: "#6b7280", fontSize: 13, marginBottom: 6 }}>{label}</div>      <div style={{ fontSize: 22, fontWeight: 900 }}>{value}</div>    </div>  );}